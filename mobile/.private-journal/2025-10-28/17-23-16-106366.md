---
title: "5:23:16 PM - October 28, 2025"
date: 2025-10-28T04:23:16.106Z
timestamp: 1761625396106
---

## Project Notes

Working on surgical test fixing approach for social_service_comment_test.dart. Found multiple issues:

**Issues Fixed**:
1. Missing `isAuthenticated` stub in setUp() - added default false return
2. Missing `createSubscription` stub for fetchCommentsForEvent tests - added with all required params
3. Incorrect use of `any` instead of `anyNamed()` for named parameters - fixed in 5 locations
4. Null return type for createSubscription - changed from `async {}` to `async => 'test_subscription_id'`
5. Async expectation issue - changed `expect` to `await expectLater` for stream test
6. Mockito verification state pollution - added `resetMockitoState()` in tearDown to clear pending verifications

**Key Learning**: Mockito has GLOBAL verification state that persists across tests when errors occur. MUST call `resetMockitoState()` in tearDown to prevent "Verification appears to be in progress" errors.

**Test Status**: Was 4/10 passing, fixing to get to 10/10.

**Pattern**: For Mockito tests with async expectations:
- Use `async` test functions
- Use `await expectLater()` instead of `expect()` for async matchers
- Always call `resetMockitoState()` in tearDown
- Use `anyNamed('param')` for named parameters, NOT `any`
